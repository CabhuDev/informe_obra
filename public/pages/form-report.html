<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Informe semanal de obra</title>
  <!-- Custom CSS -->
  <link rel="stylesheet" href="../css/style.css" />

  <!-- Favicon -->    
  <link rel="icon" type="image/webp" href="../assets/favicon.webp">
  <link rel="apple-touch-icon" sizes="180x180" href="../assets/favicon.webp">
  <link rel="shortcut icon" href="../assets/favicon.webp">
  <link rel="manifest" href="../assets/site.webmanifest">
<meta name="theme-color" content="#3B8C88">
<meta name="apple-mobile-web-app-status-bar-style" content="#3B8C88">

</head>

<body>  <main class="container">
    <!-- Bot√≥n de navegaci√≥n -->
    <div class="nav-header">
      <a href="../pages/landing.html" class="back-button" title="Volver al inicio">
        ‚Üê Volver al inicio
      </a>
    </div>
    
    <!-- Hero Section Integrada -->
    <div class="hero-banner">
      <div class="hero-content">
        <div class="hero-text">
          <h1>üìã Informe semanal</h1>
          <p class="hero-subtitle">Crea informes profesionales de obra con fotos, audio y seguimiento de avance</p>
        </div>
        <div class="hero-image">
          <img src="../assets/hero.png" alt="Obratec - Sistema de Informes de Obra" class="hero-img" />
        </div>
      </div>
    </div>

    <form id="obraForm" autocomplete="off">
      <label>
        Email
        <input type="email" name="email" placeholder="Email donde te llegar√° el informe" required />
      </label>

      <label>
        Proyecto
        <input name="projectName" placeholder="Nombre obra" required />
      </label>

      <label>
        Fecha
        <input type="date" name="date" required />
      </label>

      <label>
        Avance (%)  
        <input type="number" name="advance" min="0" max="100" required />
      </label>

      <label>
        Observaciones
        <textarea name="observations" rows="3"></textarea>
      </label>      <label>
        Incidencias
        <textarea name="incidences" rows="3"></textarea>
      </label>      <div class="photos-section">
        <label>Fotos del proyecto (m√°x 5):</label>
        <div class="photo-upload">
          <!-- Input para subir archivos -->
          <input type="file" id="photoInput" accept="image/*" multiple style="display: none;" />
          <!-- Input para captura de c√°mara en m√≥vil -->
          <input type="file" id="cameraInput" accept="image/*" capture="environment" style="display: none;" />
          
          <!-- Modal para c√°mara en desktop -->
          <div id="cameraModal" class="camera-modal" style="display: none;">
            <div class="camera-content">
              <video id="cameraVideo" autoplay muted></video>
              <canvas id="cameraCanvas" style="display: none;"></canvas>
              <div class="camera-controls">
                <button type="button" id="captureBtn" class="outline">üì∏ Capturar</button>
                <button type="button" id="closeCameraBtn" class="outline">‚ùå Cerrar</button>
              </div>
            </div>
          </div>
        </div><div id="photosContainer" class="photos-grid">
          <div id="emptyStatePhotos" class="empty-state" role="region" aria-label="Zona para a√±adir fotos">
            <div class="empty-state-content">
              <img src="../assets/empty-state.png" alt="Ilustraci√≥n de c√°mara - Sin fotos a√±adidas a√∫n" class="empty-state-img" />
              <h3>üì∑ A√±ade fotos a tu informe</h3>
              <p>Las fotos ayudan a documentar el progreso de la obra de manera visual y profesional</p>              <div class="empty-state-tips" role="list" aria-label="Opciones disponibles">
                <span class="tip clickable" role="listitem" aria-label="Opci√≥n: Tomar foto con c√°mara" 
                      data-action="take-photo" tabindex="0">üì∏ Tomar foto</span>
                <span class="tip clickable" role="listitem" aria-label="Opci√≥n: Subir archivo desde dispositivo" 
                      data-action="upload-photo" tabindex="0">üìÅ Subir archivo</span>
                <span class="tip info" role="listitem" aria-label="L√≠mite: M√°ximo 5 fotos permitidas">üí° M√°ximo 5 fotos</span>
              </div>
            </div>
          </div>
        </div>
      </div>      
      
      <div class="audio-recorder">
        <label>Observaciones de voz:</label>
        <div class="recorder-controls">
          <button type="button" id="startRecording" class="outline">üéôÔ∏è Iniciar grabaci√≥n</button>
          <button type="button" id="stopRecording" class="outline" disabled>‚èπÔ∏è Detener</button>
          <div class="recording-status-container">
            <span id="recordingStatus"></span>
            <div id="audioVisualizerContainer" style="display: none;">
              <img src="assets/audio-bars.svg" alt="Grabando..." class="audio-visualizer" />
            </div>
          </div>
        </div>
        <audio id="audioPlayback" controls style="display:none; width:100%; margin-top:10px;"></audio>
        <!-- Este campo oculto almacenar√° el audio como base64 -->
        <input type="hidden" name="audioData" id="audioData">
      </div>        <button type="submit">Enviar informe</button>
    </form>

    <div id="loadingContainer" style="display: none;" class="loading-container">
      <img src="assets/enviando-informe.svg" alt="Enviando informe..." class="loading-icon" />
      <span class="loading-text">Enviando informe...</span>
    </div>    <p id="status"></p>
    
    <!-- Scripts optimizados -->
    <script src="../js/heicConverter.js"></script>
    <script src="../js/script.js"></script>
    <script src="../js/audioRecord.js"></script>
    <script src="../js/photoManager.js"></script>
</body>
</html>
